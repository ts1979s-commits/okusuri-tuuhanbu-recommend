# 商品レコメンドLLMアプリ - プロジェクト仕様書

## 📋 **プロジェクト概要**

### プロジェクト名
お薬通販部 商品レコメンドアプリ

### 目的
ユーザーが入力した症状や悩みに基づいて、適切な医薬品・サプリメントを推奨するWebアプリケーション

### 対象ユーザー
- 健康に関心のある一般消費者
- 特定の症状に悩む方
- サプリメント購入を検討している方

## 🎯 **機能仕様**

### 主要機能

#### 1. 症状別検索機能
- **機能**: 症状（ED改善、薄毛予防、ニキビ治療など）を入力して関連商品を表示
- **実装**: テキスト入力による部分一致検索
- **対象データ**: product_recommend.csv の「効果」カラム

#### 2. 商品名検索機能
- **機能**: 商品名の一部を入力して該当商品を表示
- **実装**: 商品名による部分一致検索
- **対象データ**: product_recommend.csv の「商品名」カラム

#### 3. カテゴリ別検索機能
- **機能**: 商品カテゴリを選択して該当商品を表示
- **実装**: セレクトボックスによるカテゴリ選択
- **対象データ**: product_recommend.csv の「カテゴリ」カラム

#### 4. 専用サプリメント検索
- **機能**: 特定サプリメントに対応したカテゴリマッピング
- **実装**: supplement_mapping辞書による専用処理
- **対象商品**: 
  - スペマン → EDサプリ
  - プレミアムリジン → AGA治療薬

### 補助機能

#### 5. 重複結果防止
- **機能**: 検索結果の重複を排除
- **実装**: pandas.DataFrame.drop_duplicates()による重複除去

#### 6. FAISS高速検索（オプション）
- **機能**: ベクトル検索による高速な類似度検索
- **実装**: FAISS + OpenAI Embeddings
- **状態**: 実装済み（設定によりON/OFF可能）

## 🏗️ **技術仕様**

### アーキテクチャ
- **フロントエンド**: Streamlit
- **バックエンド**: Python
- **データベース**: CSV（product_recommend.csv）
- **検索エンジン**: 文字列マッチング + FAISS（オプション）

### 技術スタック
```
Python 3.8+
├── streamlit          # Webアプリフレームワーク
├── pandas             # データ処理
├── faiss-cpu          # ベクトル検索（オプション）
├── openai             # 埋め込みベクトル生成（オプション）
└── その他標準ライブラリ
```

### データ構造
```
data/
├── product_recommend.csv    # メイン商品データベース（35商品）
├── documents.pkl           # FAISSキャッシュ
├── faiss_index.bin         # FAISSインデックス
├── metadata.pkl            # FAISSメタデータ
└── faiss_mapping.json      # FAISS設定
```

## 📊 **データ仕様**

### 商品データベース（product_recommend.csv）
| カラム名 | データ型 | 説明 | 例 |
|----------|----------|------|-----|
| 商品名 | string | 商品の正式名称 | "スペマン" |
| 効果 | string | 商品の効果・効能 | "精子増量、性欲増進など" |
| 成分 | string | 主要成分 | "アシュワガンダ・ゴクシュラなど" |
| カテゴリ | string | 商品カテゴリ | "EDサプリ" |
| 説明 | string | 商品の詳細説明 | "スペマンは男性不妊や精子減少..." |
| URL | string | 商品ページのリンク | "https://..." |

### 商品カテゴリ一覧
- ED治療薬
- EDサプリ
- 媚薬
- AGA治療薬
- ダイエット
- 美容・スキンケア
- 性病・感染症の治療薬

## 🔍 **検索ロジック**

### 基本検索フロー
```
1. ユーザー入力受付
   ↓
2. 検索タイプ判定（症状/商品名/カテゴリ）
   ↓
3. supplement_mappingチェック
   ↓ 
4. データベース検索実行
   ↓
5. 重複除去処理
   ↓
6. 結果表示
```

### supplement_mappingロジック
```python
supplement_mapping = {
    'スペマン': 'EDサプリ',
    'プレミアムリジン': 'AGA治療薬'
}
```

## 🚀 **デプロイメント**

### デプロイ先
- **プラットフォーム**: Streamlit Cloud
- **URL**: https://okusuri-tuuhanbu-recommend.streamlit.app/
- **自動デプロイ**: GitHubプッシュ時に自動更新

### デプロイ手順
```bash
1. git add .
2. git commit -m "更新内容"
3. git push origin main
4. Streamlit Cloudが自動デプロイ
```

## 📈 **パフォーマンス指標**

### データ規模
- **商品数**: 35商品
- **カテゴリ数**: 7カテゴリ
- **検索対象フィールド**: 3フィールド（商品名、効果、カテゴリ）

### 応答性能
- **基本検索**: < 100ms
- **FAISS検索**: < 50ms
- **データロード**: < 500ms

## 🔧 **保守・運用**

### 商品データ更新
1. product_recommend.csvを更新
2. GitHubにプッシュ
3. 自動デプロイ完了

### 機能追加・修正
1. app.pyを修正
2. テスト実行
3. GitHubにプッシュ
4. 自動デプロイ完了

## 📞 **サポート情報**

### 開発者
- GitHub: ts1979s-commits
- リポジトリ: okusuri-tuuhanbu-recommend

### 更新履歴
- 2025/11/10: プロジェクト最適化完了
- 2025/11/11: ドキュメント整理